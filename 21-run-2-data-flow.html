<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>LHCb Starterkit: First Steps in LHCb</title>
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" type="text/css" href="css/bootstrap/bootstrap.css" />
    <link rel="stylesheet" type="text/css" href="css/bootstrap/bootstrap-theme.css" />
    <link rel="stylesheet" type="text/css" href="css/swc.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css" />
    <meta charset="UTF-8" />
    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <script>
     (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
     (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
     m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
     })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
     ga('create', 'UA-63818884-1', 'auto');
     ga('send', 'pageview');
    </script>
  </head>
  <body class="lesson">
    <div class="container card">
      <div class="banner">
        <a href="https://lhcb.github.io/first-analysis-steps/">
          <img src="img/starterkit.png" height="100" alt="LHCb Starterkit">
        </a>
      </div>
      <div class="row">
        <div class="col-md-10 col-md-offset-1">
          <h1 class="title">First Steps in LHCb</h1>
          <h2 class="subtitle">Changes to the data flow in Run 2</h2>
<div id="learning-objectives" class="objectives panel panel-warning">
<div class="panel-heading">
<h2><span class="glyphicon glyphicon-certificate"></span>Learning Objectives</h2>
</div>
<div class="panel-body">
<ul>
<li>Understand how the LHCb data flow differs between Run 1 and Run 2</li>
</ul>
</div>
</div>
<p>Run 1 of the LHC ran from 2010 to the end of 2012. Run 2 began in the middle of 2015 and is scheduled to continue until 2019. During Run 1 the LHC provided proton-proton collisions at a centre-of-mass energy of 7 and 8 TeV, and in Run 2 the energy increases to 13 TeV. With an increase in energy comes an increase in production cross-sections, and so a much higher rate of interesting events.</p>
<p>So now we have many more events that we would <em>like</em> to store, but as ever we're limited by computing resources. To help overcome this, LHCb introduced the <em>Turbo stream</em> in 2015, whereby the selection of candidates made in the second stage of the high level trigger, HLT2, is saved to disk and used <em>directly</em> by analysts, with no further offline reconstruction by Brunel.</p>
<p>Omitting the offline reconstruction is usually a Bad Idea because it's usually of a much better quality than the reconstruction performed in the HLT (the ‘online reconstruction’) as there's more time to run it. But, thanks an enormous effort improving the reconstruction software both online and offline in between Run 1 and Run 2, the two reconstructions now perform identically. This means if HLT2 performs all the reconstruction you need in your analysis, there's no need to wait for the offline reconstruction to run! This saves a lot of time (it's Turbo, after all), and hence money).</p>
<p>This saves time and money, but you still have many more events to save. To overcome this, events saved to the Turbo stream contain <em>only</em> the candidates that were reconstructed in the trigger. That is to say, any tracks or detector responses that don't form part of the decay that the trigger lines uses to evaluate its selection is thrown away. This is quite pragmatic, because a lot of analyses don't use this information anyway.</p>
<p>The Turbo stream runs in parallel with the regular data flow, and so everything now looks like this:</p>
<p><a href="img/lhcb_run_2_data_flow.png"><img src="img/lhcb_run_2_data_flow.png" alt="&quot;The flow of real and simulated data during Run 2 of the LHC&quot;" /></a></p>
<p>The change here is the addition of the Turbo stream in the storage output of the trigger. This stream cannot be re-reconstructed because the information needed to do that is thrown away to save disk space.</p>
<p>From our point of view, though, this doesn't change things much because we can run DaVinci over the Turbo stream in exactly the same manner as for the stripping output. We will just need to look in a different place to find the selection definitions, this time for <em>trigger lines</em> rather than stripping lines.</p>
<p>It's best to ask the trigger coordinator in your working group if your analysis has a trigger line that outputs to the Turbo stream, and if so where to find the selection definitions.</p>
        </div>
      </div>
      <div class="footer">
        <a class="label swc-blue-bg" href="http://software-carpentry.org">Software Carpentry</a>
        <a class="label swc-blue-bg" href="https://github.com/lhcb/first-analysis-steps">Source</a>
        <a class="label swc-blue-bg" href="mailto:lhcb-starterkit@cern.ch">Contact</a>
        <a class="label swc-blue-bg" href="LICENSE.html">License</a>
      </div>
    </div>
    <!-- Javascript placed at the end of the document so the pages load faster -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <script src="css/bootstrap/bootstrap-js/bootstrap.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/contrib/auto-render.min.js"></script>
    <script>
      // Go KaTeX go!
      renderMathInElement(document.body);
    </script>
  </body>
</html>
